# IMPORTANT: Replace 'username' below with your actual cPanel username
# Example: If your username is 'maddasys', change /home/username/ to /home/maddasys/

PassengerEnabled on
PassengerAppRoot /home/username/public_html/api/milk-collection-api
PassengerAppType node
PassengerStartupFile server.js
PassengerNodejs /opt/alt/alt-nodejs14/root/usr/bin/node

SetEnv NODE_ENV production
SetEnv MYSQL_HOST localhost
SetEnv MYSQL_DATABASE maddasys_milk_collection_pwa
SetEnv MYSQL_USER maddasys_tesh
SetEnv MYSQL_PASSWORD 0741899183Mutee
SetEnv MYSQL_PORT 3306
SetEnv PORT 3000

# CORS headers for all origins (including Capacitor app and Netlify)
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS, PATCH"
Header always set Access-Control-Allow-Headers "Content-Type, Accept, Authorization, X-Requested-With, Origin"
Header always set Access-Control-Max-Age "86400"

# Handle OPTIONS preflight requests at Apache level
RewriteEngine On
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

<Files "*.js">
  Order Deny,Allow
  Deny from all
</Files>
